<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tuva Learning Journey Map</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* --- Tuva Core Palette --- */
            --tuva-purple: #5B4896;
            --tuva-purple-hover: #4a3a7a;
            --tuva-bg: #FFFFFF;
            --tuva-bg-gray: #FAFAFA;
            --tuva-border: #E0E0E0;
            --tuva-text-main: #333333;
            --tuva-text-light: #666666;

            /* --- Unit Theme Colors --- */
            --theme-green: #67AC5B; /* Matches 'Place Value' in your image */
            --theme-blue: #4A90E2;  /* Matches 'Multiplication' */
            --theme-orange: #F5A623; /* Matches 'Fractions' */
            
            /* --- Layout --- */
            --sidebar-width: 260px;
            --timeline-left: 24px; /* Position of the vertical line */
            --card-indent: 60px;   /* Indentation for the cards */
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background-color: var(--tuva-bg);
            color: var(--tuva-text-main);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Sidebar (Tuva Filter Style) --- */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--tuva-bg-gray);
            border-right: 1px solid var(--tuva-border);
            display: flex;
            flex-direction: column;
            padding: 32px 0;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 0 24px 16px 24px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--tuva-text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-item {
            padding: 10px 24px;
            cursor: pointer;
            font-size: 0.95rem;
            color: var(--tuva-text-light);
            border-left: 4px solid transparent;
            background: transparent;
            text-align: left;
            border-top: none;
            border-right: none;
            border-bottom: none;
            width: 100%;
            transition: all 0.2s;
        }

        .nav-item:hover {
            color: var(--tuva-text-main);
            background-color: #F0F0F0;
        }

        .nav-item.active {
            color: var(--tuva-purple);
            font-weight: 700;
            border-left-color: var(--tuva-purple);
            background-color: #FFFFFF;
        }

        /* --- Main Content Area --- */
        .main-content {
            flex: 1;
            padding: 40px 60px;
            overflow-y: auto;
            position: relative;
        }

        .page-header {
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: var(--card-indent); /* Align with cards */
        }

        .page-header h1 {
            font-size: 1.75rem;
            font-weight: 600;
            margin: 0 0 8px 0;
            color: var(--tuva-text-main);
        }

        .page-header p {
            font-size: 1rem;
            color: var(--tuva-text-light);
            margin: 0;
        }

        /* --- Timeline Structure --- */
        .timeline-container {
            position: relative;
            max-width: 900px;
            padding-bottom: 60px; /* Space at bottom */
        }

        /* The Continuous Vertical Line */
        .timeline-line {
            position: absolute;
            left: var(--timeline-left);
            top: 10px;
            bottom: 0;
            width: 2px;
            background-color: var(--tuva-border);
            z-index: 0;
        }

        /* Unit Group Container */
        .unit-group {
            margin-bottom: 40px;
            position: relative;
        }

        /* Unit Marker (Dot + Label) */
        .unit-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            position: relative;
        }

        .unit-dot {
            width: 14px;
            height: 14px;
            background-color: var(--tuva-bg);
            border: 2px solid #ccc; /* Default */
            border-radius: 50%;
            position: absolute;
            left: calc(var(--timeline-left) - 7px); /* Centered on line */
            z-index: 2;
        }

        .unit-label {
            margin-left: var(--card-indent);
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--tuva-text-light);
        }

        /* Coloring based on Theme */
        .unit-group[data-theme="green"] .unit-dot { border-color: var(--theme-green); }
        .unit-group[data-theme="green"] .unit-label { color: var(--theme-green); }

        .unit-group[data-theme="blue"] .unit-dot { border-color: var(--theme-blue); }
        .unit-group[data-theme="blue"] .unit-label { color: var(--theme-blue); }

        .unit-group[data-theme="orange"] .unit-dot { border-color: var(--theme-orange); }
        .unit-group[data-theme="orange"] .unit-label { color: var(--theme-orange); }


        /* --- Skill Card (The Node) --- */
        .skill-node {
            margin-left: var(--card-indent);
            margin-bottom: 16px;
        }

        /* The Clickable Card Header */
        .skill-card-header {
            background-color: var(--tuva-bg);
            border: 1px solid var(--tuva-border);
            border-radius: 4px;
            padding: 18px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: border-color 0.2s, background-color 0.1s;
            position: relative;
        }

        .skill-card-header:hover {
            border-color: var(--tuva-purple);
            background-color: #FBFAFF; /* Extremely light purple tint */
        }

        .skill-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .skill-number {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--tuva-text-light);
            width: 24px;
        }

        .skill-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--tuva-text-main);
        }

        .activity-count {
            background-color: #F0F0F0;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--tuva-text-light);
        }

        /* --- Expanded Content (Inline List) --- */
        .activities-list {
            display: none; /* Hidden by default */
            border-left: 1px solid var(--tuva-border);
            border-right: 1px solid var(--tuva-border);
            border-bottom: 1px solid var(--tuva-border);
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            margin-top: -1px; /* Overlap border */
            background-color: #FAFAFA; /* Slightly differentiated bg */
            padding: 16px 24px;
        }

        .activities-list.open {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .lesson-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #EAEAEA;
        }

        .lesson-item:last-child {
            border-bottom: none;
        }

        .lesson-detail {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .lesson-context {
            font-size: 0.7rem;
            text-transform: uppercase;
            font-weight: 700;
            color: var(--tuva-text-light);
        }

        .lesson-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--tuva-text-main);
            text-decoration: none;
        }
        
        .lesson-title:hover {
            color: var(--tuva-purple);
            text-decoration: underline;
        }

        .btn-assign {
            padding: 6px 16px;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--tuva-purple);
            border: 1px solid var(--tuva-purple);
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-assign:hover {
            background-color: var(--tuva-purple);
            color: white;
        }

        /* Active State for Parent Card */
        .skill-card-header.active {
            border-color: var(--tuva-purple);
            border-bottom-color: transparent; /* Seamless merge */
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            background-color: #FFF;
        }

        /* --- Scrollbar Polish --- */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #ccc; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #bbb; 
        }

    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-header">Learning Map</div>
        
        <button class="nav-item active" onclick="loadGrade('grade3', this)">Grade 3</button>
        <button class="nav-item" onclick="loadGrade('grade4', this)">Grade 4</button>
        <button class="nav-item" onclick="loadGrade('grade5', this)">Grade 5</button>
        
        <div style="margin-top: 30px;">
             <div class="sidebar-header">Subject</div>
             <div class="nav-item" style="cursor: default; opacity: 0.6;">Mathematics</div>
             <div class="nav-item" style="cursor: default; opacity: 0.6;">Science</div>
        </div>
    </aside>

    <main class="main-content">
        <div class="page-header">
            <h1 id="grade-heading">Grade 3 Mathematics</h1>
            <p>Select a skill to view real-world data activities aligned to your curriculum.</p>
        </div>

        <div class="timeline-container">
            <div class="timeline-line"></div>

            <div id="timeline-content"></div>
        </div>
    </main>

    <script>
        // Data derived from the provided spreadsheet/context
        const curriculumData = {
            grade3: [
                {
                    unitName: "Place Value & Number Sense",
                    theme: "green",
                    skills: [
                        {
                            id: 1,
                            name: "Round numbers to nearest 100",
                            lessons: [
                                { title: "How High Are We? Altitudes of Cities", context: "Environment" },
                                { title: "Counting Calories", context: "Food & Farming" },
                                { title: "Charge it Up! Estimating EV Ranges", context: "Industry & Tech" }
                            ]
                        }
                    ]
                },
                {
                    unitName: "Introduction to Multiplication",
                    theme: "blue",
                    skills: [
                        {
                            id: 2,
                            name: "Understand multiplication as equal groups",
                            lessons: [
                                { title: "How Many Animals at the Zoo?", context: "Animals" },
                                { title: "School Garden Harvest", context: "Food & Farming" },
                                { title: "Recycling Collection at School", context: "Environment" }
                            ]
                        }
                    ]
                },
                {
                    unitName: "Understanding Fractions",
                    theme: "orange",
                    skills: [
                        {
                            id: 3,
                            name: "Compare fractions with same denominators",
                            lessons: [
                                { title: "What's on Your Plate?", context: "Health" },
                                { title: "FIFA World Cup Goals by Country", context: "Sports" }
                            ]
                        }
                    ]
                }
            ],
            grade4: [
                 {
                    unitName: "Division",
                    theme: "blue",
                    skills: [
                        { id: 4, name: "Divide up to 4-Digit Numbers", lessons: [
                            { title: "Packing Eggs on a Farm", context: "Farming" }
                        ]}
                    ]
                },
                {
                    unitName: "Factors & Multiples",
                    theme: "green",
                    skills: [
                        { id: 5, name: "Identify Factors and Multiples", lessons: [
                            { title: "Common Units of Time", context: "Science" }
                        ]}
                    ]
                }
            ],
            grade5: []
        };

        function loadGrade(gradeKey, btnElement) {
            // UI Toggle
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            if(btnElement) btnElement.classList.add('active');

            // Header Update
            const titles = { 'grade3': 'Grade 3 Mathematics', 'grade4': 'Grade 4 Mathematics', 'grade5': 'Grade 5 Mathematics' };
            document.getElementById('grade-heading').innerText = titles[gradeKey];

            const container = document.getElementById('timeline-content');
            container.innerHTML = '';
            
            const data = curriculumData[gradeKey];

            if (!data || data.length === 0) {
                container.innerHTML = '<div style="margin-left:60px; color:#666; padding: 20px 0;">No curriculum data available.</div>';
                return;
            }

            // Render Units
            data.forEach(unit => {
                const group = document.createElement('div');
                group.className = 'unit-group';
                group.setAttribute('data-theme', unit.theme);

                // 1. Unit Header (Dot + Label)
                const header = document.createElement('div');
                header.className = 'unit-header';
                header.innerHTML = `
                    <div class="unit-dot"></div>
                    <div class="unit-label">${unit.unitName}</div>
                `;
                group.appendChild(header);

                // 2. Skills (Cards)
                unit.skills.forEach(skill => {
                    const node = document.createElement('div');
                    node.className = 'skill-node';
                    
                    // Card Content
                    const cardHeader = document.createElement('div');
                    cardHeader.className = 'skill-card-header';
                    cardHeader.onclick = function() { toggleActivities(this); };
                    cardHeader.innerHTML = `
                        <div class="skill-info">
                            <span class="skill-number">${skill.id}.</span>
                            <span class="skill-title">${skill.name}</span>
                        </div>
                        <span class="activity-count">${skill.lessons.length} Activities</span>
                    `;

                    // Accordion Body (Activities)
                    const activityList = document.createElement('div');
                    activityList.className = 'activities-list';
                    
                    if (skill.lessons.length > 0) {
                        skill.lessons.forEach(lesson => {
                            const item = document.createElement('div');
                            item.className = 'lesson-item';
                            item.innerHTML = `
                                <div class="lesson-detail">
                                    <span class="lesson-context" style="color:${getThemeColor(unit.theme)}">${lesson.context}</span>
                                    <a href="#" class="lesson-title">${lesson.title}</a>
                                </div>
                                <button class="btn-assign">Assign</button>
                            `;
                            activityList.appendChild(item);
                        });
                    } else {
                        activityList.innerHTML = '<div style="color:#999; font-size:0.9rem;">No activities currently mapped.</div>';
                    }

                    node.appendChild(cardHeader);
                    node.appendChild(activityList);
                    group.appendChild(node);
                });

                container.appendChild(group);
            });
        }

        // Helper to get hex from theme name for inline styles
        function getThemeColor(theme) {
            const colors = { 'green': '#67AC5B', 'blue': '#4A90E2', 'orange': '#F5A623' };
            return colors[theme] || '#666';
        }

        // Accordion Toggle Logic
        function toggleActivities(headerElement) {
            const list = headerElement.nextElementSibling;
            const isOpen = list.classList.contains('open');

            // Close all others (Optional: comment out if you want multiple open)
            // document.querySelectorAll('.activities-list').forEach(el => el.classList.remove('open'));
            // document.querySelectorAll('.skill-card-header').forEach(el => el.classList.remove('active'));

            if (!isOpen) {
                list.classList.add('open');
                headerElement.classList.add('active');
            } else {
                list.classList.remove('open');
                headerElement.classList.remove('active');
            }
        }

        // Initial Load
        loadGrade('grade3', document.querySelector('.nav-item.active'));

    </script>
</body>
</html>

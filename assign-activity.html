<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tuva - Assign Activity Modal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js">
  <style>
    :root {
      --tuva-green: #004445;
      --tuva-magenta: #8c1a64;
      --light-teal-bg: #e8f4f4;
    }
    body { font-family: system-ui, -apple-system, sans-serif; }
    .btn-tuva-green { background-color: var(--tuva-green); }
    .btn-tuva-green:hover { background-color: #003334; }
    .text-tuva-green { color: var(--tuva-green); }
    .text-tuva-magenta { color: var(--tuva-magenta); }
    .border-tuva-green { border-color: var(--tuva-green); }
    .bg-light-teal { background-color: var(--light-teal-bg); }
    .toggle-btn.active { background-color: var(--tuva-green); color: white; }
    .toggle-btn:not(.active) { background-color: white; color: #374151; }
  </style>
</head>
<body class="min-h-screen bg-slate-500/50 py-8 px-4 overflow-auto">
  <div class="max-w-xl mx-auto">
    
    <!-- Main Modal -->
    <div class="bg-white rounded-xl shadow-2xl w-full overflow-hidden">
      <!-- Header -->
      <div class="relative">
        <button class="absolute top-4 right-4 p-2 hover:bg-slate-100 rounded-lg transition-colors z-10">
          <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
        
        <div class="px-6 pt-5 pb-4">
          <h1 class="text-2xl font-bold text-slate-900">Assign Activity</h1>
        </div>
        
        <div class="px-6 py-5 bg-light-teal">
          <h2 class="text-lg font-bold mb-3 text-tuva-green">
            Introductory Lesson 3: Creating and Marking Up Graphs
          </h2>
          <div class="flex items-center gap-6">
            <span class="flex items-center gap-2">
              <svg class="w-5 h-5 text-tuva-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
              <span class="font-medium text-sm text-tuva-green">Foran(By Tuva Staff)</span>
            </span>
            <span class="flex items-center gap-2">
              <svg class="w-5 h-5 text-tuva-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="4" y1="6" x2="20" y2="6" stroke-width="2"/><line x1="4" y1="12" x2="14" y2="12" stroke-width="2"/><line x1="4" y1="18" x2="18" y2="18" stroke-width="2"/></svg>
              <span class="font-medium text-sm text-slate-700">8 Steps</span>
            </span>
          </div>
        </div>
      </div>

      <!-- Content Area -->
      <div class="p-6" id="modalContent">
        <!-- Year Toggle -->
        <div class="flex justify-center mb-6">
          <div class="inline-flex overflow-hidden border-2 border-tuva-green" style="border-radius: 8px;">
            <button onclick="switchTab('current')" id="tabCurrent" class="toggle-btn active px-5 py-2.5 text-sm font-semibold transition-all flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke-width="2"/><line x1="16" y1="2" x2="16" y2="6" stroke-width="2"/><line x1="8" y1="2" x2="8" y2="6" stroke-width="2"/><line x1="3" y1="10" x2="21" y2="10" stroke-width="2"/></svg>
              Current Year (2025-26)
            </button>
            <button onclick="switchTab('past')" id="tabPast" class="toggle-btn px-5 py-2.5 text-sm font-semibold transition-all flex items-center gap-2">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><polyline points="12,6 12,12 16,14" stroke-width="2"/></svg>
              Past Year
            </button>
          </div>
        </div>

        <!-- Class List Container -->
        <div id="classListContainer">
          <!-- Empty State -->
          <div id="emptyState" class="text-center py-8">
            <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
            </div>
            <h3 class="text-lg font-bold text-slate-700 mb-2">No Classes Created</h3>
            <p class="text-sm text-slate-500 mb-5">Create a class first to assign this activity to your students.</p>
            <button onclick="showAddClassForm()" class="inline-flex items-center gap-2 px-5 py-2.5 text-white font-bold text-sm transition-colors btn-tuva-green" style="border-radius: 8px;">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
              Create Class
            </button>
          </div>

          <!-- Add Class Form -->
          <div id="addClassForm" class="hidden border-2 border-slate-200 rounded-lg p-5 bg-slate-50">
            <h3 class="text-lg font-bold text-slate-800 mb-4">Add a Class</h3>
            <div class="space-y-4">
              <div class="flex items-center gap-4">
                <label class="text-sm font-medium text-slate-700 w-20">Grade</label>
                <div class="flex-1 relative">
                  <select id="newClassGrade" class="w-full px-4 py-2.5 border border-slate-300 rounded-lg text-sm appearance-none bg-white focus:outline-none focus:border-slate-400">
                    <option value="">Please select</option>
                    <option>K</option><option>1st Grade</option><option>2nd Grade</option><option>3rd Grade</option><option>4th Grade</option><option>5th Grade</option><option>6th Grade</option><option>7th Grade</option><option>8th Grade</option><option>9th Grade</option><option>10th Grade</option><option>11th Grade</option><option>12th Grade</option>
                  </select>
                  <svg class="w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
              </div>
              <div class="flex items-center gap-4">
                <label class="text-sm font-medium text-slate-700 w-20">Section*</label>
                <input type="text" id="newClassSection" placeholder="e.g., Science, Math" class="flex-1 px-4 py-2.5 border border-slate-300 rounded-lg text-sm focus:outline-none focus:border-slate-400">
              </div>
              <div class="flex items-center gap-4">
                <label class="text-sm font-medium text-slate-700 w-20">Course</label>
                <div class="flex-1 relative">
                  <select id="newClassCourse" class="w-full px-4 py-2.5 border border-slate-300 rounded-lg text-sm appearance-none bg-white focus:outline-none focus:border-slate-400">
                    <option value="">Search</option>
                    <option>Mathematics</option><option>Science</option><option>Social Studies</option>
                  </select>
                  <svg class="w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                </div>
              </div>
              <div class="flex items-center justify-end gap-3 pt-2">
                <button onclick="hideAddClassForm()" class="px-5 py-2 border-2 border-slate-800 text-slate-800 font-bold text-sm transition-colors bg-white" style="border-radius: 8px;">Cancel</button>
                <button onclick="addClass()" class="px-5 py-2 text-white font-bold text-sm transition-colors btn-tuva-green" style="border-radius: 8px;">Add</button>
              </div>
            </div>
          </div>

          <!-- Current Year Classes -->
          <div id="currentYearClasses" class="hidden">
            <div class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Select a class to assign</div>
            <div id="currentClassList"></div>
            <button onclick="showAddClassFormInline()" class="flex items-center gap-2 text-sm font-semibold mt-4 text-tuva-magenta hover:underline">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
              Add another class
            </button>
            <!-- Inline Add Class Form for Current Year -->
            <div id="inlineAddClassForm" class="hidden mt-4"></div>
          </div>

          <!-- Past Year Classes -->
          <div id="pastYearClasses" class="hidden">
            <div class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Past Year Classes</div>
            <div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-3 mb-4">
              <div class="flex items-start gap-2">
                <svg class="w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><line x1="12" y1="8" x2="12" y2="12" stroke-width="2"/><line x1="12" y1="16" x2="12.01" y2="16" stroke-width="2"/></svg>
                <p class="text-sm text-amber-800">You can still assign activities to past year classes. Use the Archive option to move classes you no longer need.</p>
              </div>
            </div>
            <div id="pastClassList"></div>
          </div>
        </div>

        <!-- Assignment Options -->
        <div id="assignmentOptions" class="hidden">
          <div class="border-2 rounded-lg p-4 mb-6 bg-light-teal border-tuva-green">
            <div class="text-xs font-bold uppercase tracking-wider mb-1 text-tuva-green">Assigning to</div>
            <div class="flex items-center gap-2">
              <span id="selectedClassName" class="font-bold text-slate-800 text-base"></span>
              <span id="selectedClassCode" class="px-2 py-0.5 rounded font-mono text-xs" style="background-color: #d1e7e7; color: #004445;"></span>
            </div>
          </div>
          <div class="space-y-5">
            <div>
              <label class="block text-sm font-bold text-slate-700 mb-3">Assign To</label>
              <div class="flex gap-4">
                <label class="flex items-center gap-2.5 cursor-pointer">
                  <input type="radio" name="assignTo" value="entire" checked class="w-4 h-4" style="accent-color: #004445;">
                  <span class="text-sm font-medium text-slate-700">Entire Class</span>
                </label>
                <label class="flex items-center gap-2.5 cursor-pointer">
                  <input type="radio" name="assignTo" value="individual" class="w-4 h-4" style="accent-color: #004445;">
                  <span class="text-sm font-medium text-slate-700">Individual Students</span>
                </label>
              </div>
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 mb-2">Schedule Date</label>
              <input type="date" value="2026-01-28" class="w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-sm focus:outline-none">
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 mb-2">Points</label>
              <input type="number" value="10" class="w-28 px-4 py-3 border-2 border-slate-300 rounded-lg text-sm focus:outline-none">
            </div>
            <div>
              <label class="block text-sm font-bold text-slate-700 mb-2">Assignment Instructions <span class="text-slate-400 font-normal">(Optional)</span></label>
              <textarea placeholder="Add any special instructions for students..." rows="3" class="w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-sm focus:outline-none resize-none"></textarea>
            </div>
          </div>
          <div class="flex items-center gap-3 mt-6 pt-5 border-t border-slate-200">
            <button onclick="backToList()" class="flex-1 px-4 py-3 border-2 font-bold text-sm transition-colors bg-white border-tuva-green text-tuva-green" style="border-radius: 8px;">Back to Class List</button>
            <button onclick="confirmAssign()" id="confirmAssignBtn" class="flex-1 px-4 py-3 text-white font-bold text-sm transition-colors shadow btn-tuva-green" style="border-radius: 8px;">Assign</button>
          </div>
        </div>

        <!-- Success State -->
        <div id="successState" class="hidden py-10 text-center">
          <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: #dcfce7;">
            <svg class="w-8 h-8 text-tuva-green" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
          </div>
          <h3 class="text-xl font-bold text-slate-800 mb-2">Activity Assigned!</h3>
          <p id="successMessage" class="text-slate-600 text-base"></p>
        </div>
      </div>
    </div>

    <!-- Demo Toggle -->
    <div class="mt-6 text-center">
      <button onclick="resetDemo()" class="text-sm text-white/80 hover:text-white underline">Reset Demo</button>
    </div>
  </div>

  <script>
    // State
    let currentTab = 'current';
    let classes = [];
    let pastClasses = [
      { id: 5, name: '5th Grade', section: 'Science', code: 'old123', students: 25, year: '2024-25', assigned: false },
      { id: 6, name: '6th Grade', section: 'Math', code: 'old456', students: 30, year: '2024-25', assigned: false },
      { id: 7, name: '4th Grade', section: 'Science', code: 'old789', students: 22, year: '2024-25', assigned: false }
    ];
    let selectedClass = null;

    function generateCode() {
      return Math.random().toString(36).substring(2, 7);
    }

    function switchTab(tab) {
      currentTab = tab;
      document.getElementById('tabCurrent').classList.toggle('active', tab === 'current');
      document.getElementById('tabPast').classList.toggle('active', tab === 'past');
      // Hide inline add class form when switching tabs
      const inlineForm = document.getElementById('inlineAddClassForm');
      if (inlineForm) {
        inlineForm.classList.add('hidden');
        inlineForm.innerHTML = '';
      }
      renderClassList();
    }

    function renderClassList() {
      const emptyState = document.getElementById('emptyState');
      const addClassForm = document.getElementById('addClassForm');
      const currentYearClasses = document.getElementById('currentYearClasses');
      const pastYearClasses = document.getElementById('pastYearClasses');
      const inlineAddClassForm = document.getElementById('inlineAddClassForm');

      emptyState.classList.add('hidden');
      currentYearClasses.classList.add('hidden');
      pastYearClasses.classList.add('hidden');
      
      // Hide inline form when switching tabs
      if (inlineAddClassForm) {
        inlineAddClassForm.classList.add('hidden');
        inlineAddClassForm.innerHTML = '';
      }

      if (currentTab === 'current') {
        if (classes.length === 0 && addClassForm.classList.contains('hidden')) {
          emptyState.classList.remove('hidden');
        } else if (classes.length > 0) {
          addClassForm.classList.add('hidden');
          currentYearClasses.classList.remove('hidden');
          renderCurrentClasses();
        }
      } else {
        // Past Year - hide add class form
        addClassForm.classList.add('hidden');
        pastYearClasses.classList.remove('hidden');
        renderPastClasses();
      }
    }

    function renderCurrentClasses() {
      const container = document.getElementById('currentClassList');
      container.innerHTML = classes.map(cls => `
        <div class="border-2 rounded-lg p-4 transition-all mb-3 ${cls.assigned ? 'bg-emerald-50 border-emerald-300' : 'bg-white border-slate-200 hover:border-slate-400 hover:shadow cursor-pointer'}" ${!cls.assigned ? `onclick="selectClass(${cls.id})"` : ''}>
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-1.5 flex-wrap">
                <span class="font-bold text-slate-800 text-lg">${cls.name} - ${cls.section}</span>
                <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded font-mono text-xs border border-slate-200">${cls.code}</span>
                ${cls.isNew ? '<span class="px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs font-bold">New</span>' : ''}
              </div>
              <div class="flex items-center gap-3 text-sm text-slate-500 mt-1">
                <span class="flex items-center gap-1.5">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
                  ${cls.students} students
                </span>
              </div>
            </div>
            ${cls.assigned ? `
              <div class="flex items-center gap-2 px-4 py-2 bg-emerald-100 text-emerald-700 rounded-lg border border-emerald-300">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                <span class="text-sm font-bold">Assigned</span>
              </div>
            ` : `
              <button class="flex items-center gap-2 px-6 py-3 text-white font-bold text-sm transition-colors btn-tuva-green" style="border-radius: 8px;">
                Assign
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              </button>
            `}
          </div>
        </div>
      `).join('');
    }

    function renderPastClasses() {
      const container = document.getElementById('pastClassList');
      container.innerHTML = pastClasses.map(cls => `
        <div class="border-2 rounded-lg p-4 transition-all mb-3 ${cls.assigned ? 'bg-emerald-50 border-emerald-300' : 'bg-white border-slate-200 hover:border-slate-400 hover:shadow cursor-pointer'}" ${!cls.assigned ? `onclick="selectPastClass(${cls.id})"` : ''}>
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-1.5 flex-wrap">
                <span class="font-bold text-slate-800 text-lg">${cls.name} - ${cls.section}</span>
                <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded font-mono text-xs border border-slate-200">${cls.code}</span>
                <span class="px-2.5 py-1 bg-slate-200 text-slate-700 rounded text-xs font-bold">${cls.year}</span>
              </div>
              <div class="flex items-center gap-3 text-sm text-slate-500 mt-1">
                <span class="flex items-center gap-1.5">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/></svg>
                  ${cls.students} students
                </span>
              </div>
            </div>
            ${cls.assigned ? `
              <div class="flex items-center gap-2 px-4 py-2 bg-emerald-100 text-emerald-700 rounded-lg border border-emerald-300">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                <span class="text-sm font-bold">Assigned</span>
              </div>
            ` : `
              <div class="flex flex-col items-center gap-2">
                <button class="flex items-center gap-2 px-6 py-3 text-white font-bold text-sm transition-colors btn-tuva-green" style="border-radius: 8px;">
                  Assign
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                </button>
                <button onclick="event.stopPropagation(); archiveClass(${cls.id})" class="flex items-center gap-1.5 text-xs font-semibold transition-colors text-tuva-magenta hover:underline">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/></svg>
                  Archive class
                </button>
              </div>
            `}
          </div>
        </div>
      `).join('');
    }

    function showAddClassForm() {
      document.getElementById('emptyState').classList.add('hidden');
      document.getElementById('addClassForm').classList.remove('hidden');
    }

    function hideAddClassForm() {
      document.getElementById('addClassForm').classList.add('hidden');
      renderClassList();
    }

    function showAddClassFormInline() {
      const inlineForm = document.getElementById('inlineAddClassForm');
      inlineForm.innerHTML = `
        <div class="border-2 border-slate-200 rounded-lg p-5 bg-slate-50">
          <h3 class="text-lg font-bold text-slate-800 mb-4">Add a Class</h3>
          <div class="space-y-4">
            <div class="flex items-center gap-4">
              <label class="text-sm font-medium text-slate-700 w-20">Grade</label>
              <div class="flex-1 relative">
                <select id="inlineNewClassGrade" class="w-full px-4 py-2.5 border border-slate-300 rounded-lg text-sm appearance-none bg-white focus:outline-none focus:border-slate-400">
                  <option value="">Please select</option>
                  <option>K</option><option>1st Grade</option><option>2nd Grade</option><option>3rd Grade</option><option>4th Grade</option><option>5th Grade</option><option>6th Grade</option><option>7th Grade</option><option>8th Grade</option><option>9th Grade</option><option>10th Grade</option><option>11th Grade</option><option>12th Grade</option>
                </select>
                <svg class="w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <label class="text-sm font-medium text-slate-700 w-20">Section*</label>
              <input type="text" id="inlineNewClassSection" placeholder="e.g., Science, Math" class="flex-1 px-4 py-2.5 border border-slate-300 rounded-lg text-sm focus:outline-none focus:border-slate-400">
            </div>
            <div class="flex items-center gap-4">
              <label class="text-sm font-medium text-slate-700 w-20">Course</label>
              <div class="flex-1 relative">
                <select id="inlineNewClassCourse" class="w-full px-4 py-2.5 border border-slate-300 rounded-lg text-sm appearance-none bg-white focus:outline-none focus:border-slate-400">
                  <option value="">Search</option>
                  <option>Mathematics</option><option>Science</option><option>Social Studies</option>
                </select>
                <svg class="w-4 h-4 text-slate-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
              </div>
            </div>
            <div class="flex items-center justify-end gap-3 pt-2">
              <button onclick="hideInlineAddClassForm()" class="px-5 py-2 border-2 border-slate-800 text-slate-800 font-bold text-sm transition-colors bg-white" style="border-radius: 8px;">Cancel</button>
              <button onclick="addClassInline()" class="px-5 py-2 text-white font-bold text-sm transition-colors btn-tuva-green" style="border-radius: 8px;">Add</button>
            </div>
          </div>
        </div>
      `;
      inlineForm.classList.remove('hidden');
    }

    function hideInlineAddClassForm() {
      document.getElementById('inlineAddClassForm').classList.add('hidden');
      document.getElementById('inlineAddClassForm').innerHTML = '';
    }

    function addClassInline() {
      const grade = document.getElementById('inlineNewClassGrade').value;
      const section = document.getElementById('inlineNewClassSection').value;
      
      if (grade && section) {
        const newClass = {
          id: Date.now(),
          name: grade,
          section: section,
          code: generateCode(),
          students: 0,
          assigned: false,
          isNew: true
        };
        classes.push(newClass);
        hideInlineAddClassForm();
        renderClassList();
      }
    }

    function addClass() {
      const grade = document.getElementById('newClassGrade').value;
      const section = document.getElementById('newClassSection').value;
      
      if (grade && section) {
        const newClass = {
          id: Date.now(),
          name: grade,
          section: section,
          code: generateCode(),
          students: 0,
          assigned: false,
          isNew: true
        };
        classes.push(newClass);
        document.getElementById('newClassGrade').value = '';
        document.getElementById('newClassSection').value = '';
        document.getElementById('newClassCourse').value = '';
        document.getElementById('addClassForm').classList.add('hidden');
        renderClassList();
      }
    }

    function selectClass(id) {
      selectedClass = classes.find(c => c.id === id);
      showAssignmentOptions();
    }

    function selectPastClass(id) {
      selectedClass = pastClasses.find(c => c.id === id);
      showAssignmentOptions();
    }

    function showAssignmentOptions() {
      document.getElementById('classListContainer').classList.add('hidden');
      document.getElementById('assignmentOptions').classList.remove('hidden');
      document.getElementById('selectedClassName').textContent = `${selectedClass.name} - ${selectedClass.section}`;
      document.getElementById('selectedClassCode').textContent = selectedClass.code;
      document.getElementById('confirmAssignBtn').textContent = `Assign to ${selectedClass.section}`;
    }

    function backToList() {
      document.getElementById('assignmentOptions').classList.add('hidden');
      document.getElementById('classListContainer').classList.remove('hidden');
      selectedClass = null;
    }

    function confirmAssign() {
      if (selectedClass) {
        // Update the assigned status
        if (currentTab === 'current') {
          const cls = classes.find(c => c.id === selectedClass.id);
          if (cls) cls.assigned = true;
        } else {
          const cls = pastClasses.find(c => c.id === selectedClass.id);
          if (cls) cls.assigned = true;
        }
        
        // Show success
        document.getElementById('assignmentOptions').classList.add('hidden');
        document.getElementById('successState').classList.remove('hidden');
        document.getElementById('successMessage').textContent = `Successfully assigned to ${selectedClass.name} - ${selectedClass.section}`;
        
        // Return to list after delay
        setTimeout(() => {
          document.getElementById('successState').classList.add('hidden');
          document.getElementById('classListContainer').classList.remove('hidden');
          selectedClass = null;
          renderClassList();
        }, 2000);
      }
    }

    function archiveClass(id) {
      pastClasses = pastClasses.filter(c => c.id !== id);
      renderPastClasses();
    }

    function resetDemo() {
      classes = [];
      pastClasses = [
        { id: 5, name: '5th Grade', section: 'Science', code: 'old123', students: 25, year: '2024-25', assigned: false },
        { id: 6, name: '6th Grade', section: 'Math', code: 'old456', students: 30, year: '2024-25', assigned: false },
        { id: 7, name: '4th Grade', section: 'Science', code: 'old789', students: 22, year: '2024-25', assigned: false }
      ];
      selectedClass = null;
      currentTab = 'current';
      document.getElementById('tabCurrent').classList.add('active');
      document.getElementById('tabPast').classList.remove('active');
      document.getElementById('assignmentOptions').classList.add('hidden');
      document.getElementById('successState').classList.add('hidden');
      document.getElementById('classListContainer').classList.remove('hidden');
      document.getElementById('addClassForm').classList.add('hidden');
      const inlineForm = document.getElementById('inlineAddClassForm');
      if (inlineForm) {
        inlineForm.classList.add('hidden');
        inlineForm.innerHTML = '';
      }
      renderClassList();
    }

    // Initialize
    renderClassList();
  </script>
</body>
</html>
